{"ast":null,"code":"import _objectSpread from\"/home/bogdan/project-manager-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/bogdan/project-manager-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bogdan/project-manager-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{refreshOperation,token}from'../auth/auth-operations';import{createProjectError,createProjectRequest,createProjectSuccess,projectsSuccess,deleteProjectRequest,deleteProjectSuccess,deleteProjectError,editProjectTitleRequest,editProjectTitleSuccess,editProjectTitleError,projectsRequest,addMemberError,addMemberRequest,addMemberSuccess,projectsError}from'./projects-actions';export var refreshTemplate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(callback,error,dispatch){var _error$response,_error$response2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401||((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===404)){_context.next=10;break;}_context.prev=1;_context.next=4;return dispatch(refreshOperation());case 4:dispatch(callback());_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);token.unset();case 10:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return function refreshTemplate(_x,_x2,_x3){return _ref.apply(this,arguments);};}();var getProjects=function getProjects(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(projectsRequest());_context2.prev=1;_context2.next=4;return axios.get('https://sbc-backend.goit.global/project');case 4:response=_context2.sent;dispatch(projectsSuccess(response.data.constructor.name==='Array'?response.data:[]));_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch(projectsError(_context2.t0===null||_context2.t0===void 0?void 0:_context2.t0.message));refreshTemplate(getProjects,_context2.t0,dispatch);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x4){return _ref2.apply(this,arguments);};}();};var createProject=function createProject(project){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var _yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(createProjectRequest());_context3.prev=1;_context3.next=4;return axios.post('https://sbc-backend.goit.global/project',project);case 4:_yield$axios$post=_context3.sent;data=_yield$axios$post.data;dispatch(createProjectSuccess(_objectSpread(_objectSpread({},data),{},{_id:data.id})));_context3.next=13;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);dispatch(createProjectError(_context3.t0===null||_context3.t0===void 0?void 0:_context3.t0.message));refreshTemplate(function(){return createProject(project);},_context3.t0,dispatch);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function(_x5){return _ref3.apply(this,arguments);};}();};var deleteProject=function deleteProject(projectId){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var newID;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:newID=projectId;dispatch(deleteProjectRequest());try{axios.delete(\"https://sbc-backend.goit.global/project/\".concat(newID));dispatch(deleteProjectSuccess(newID));}catch(error){dispatch(deleteProjectError(error===null||error===void 0?void 0:error.message));refreshTemplate(function(){return deleteProject(projectId);},error,dispatch);}case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x6){return _ref4.apply(this,arguments);};}();};axios.defaults.baseURL='https://sbc-backend.goit.global';var addMember=function addMember(email,projectId){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var _yield$axios$patch,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:dispatch(addMemberRequest());_context5.prev=1;_context5.next=4;return axios.patch(\"/project/contributor/\".concat(projectId),email);case 4:_yield$axios$patch=_context5.sent;data=_yield$axios$patch.data;dispatch(addMemberSuccess({members:data.newMembers,projectId:projectId}));_context5.next=13;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](1);dispatch(addMemberError(_context5.t0===null||_context5.t0===void 0?void 0:_context5.t0.message));refreshTemplate(function(){return addMember(email,projectId);},_context5.t0,dispatch);case 13:case\"end\":return _context5.stop();}}},_callee5,null,[[1,9]]);}));return function(_x7){return _ref5.apply(this,arguments);};}();};var editTitle=function editTitle(projectId,title){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:dispatch(editProjectTitleRequest());_context6.prev=1;_context6.next=4;return axios.patch(\"/project/title/\".concat(projectId),{title:title});case 4:dispatch(editProjectTitleSuccess({projectId:projectId,title:title}));_context6.next=11;break;case 7:_context6.prev=7;_context6.t0=_context6[\"catch\"](1);dispatch(editProjectTitleError(_context6.t0===null||_context6.t0===void 0?void 0:_context6.t0.message));refreshTemplate(function(){return editTitle(projectId,title);},_context6.t0,dispatch);case 11:case\"end\":return _context6.stop();}}},_callee6,null,[[1,7]]);}));return function(_x8){return _ref6.apply(this,arguments);};}();};export{getProjects,createProject,deleteProject,editTitle,addMember};","map":{"version":3,"sources":["/home/bogdan/project-manager-app/src/redux/projects/projects-operations.js"],"names":["axios","refreshOperation","token","createProjectError","createProjectRequest","createProjectSuccess","projectsSuccess","deleteProjectRequest","deleteProjectSuccess","deleteProjectError","editProjectTitleRequest","editProjectTitleSuccess","editProjectTitleError","projectsRequest","addMemberError","addMemberRequest","addMemberSuccess","projectsError","refreshTemplate","callback","error","dispatch","response","status","unset","getProjects","get","data","constructor","name","message","createProject","project","post","_id","id","deleteProject","projectId","newID","delete","defaults","baseURL","addMember","email","patch","members","newMembers","editTitle","title"],"mappings":"qVAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,gBAAT,CAA2BC,KAA3B,KAAwC,yBAAxC,CACA,OACEC,kBADF,CAEEC,oBAFF,CAGEC,oBAHF,CAIEC,eAJF,CAKEC,oBALF,CAMEC,oBANF,CAOEC,kBAPF,CAQEC,uBARF,CASEC,uBATF,CAUEC,qBAVF,CAWEC,eAXF,CAYEC,cAZF,CAaEC,gBAbF,CAcEC,gBAdF,CAeEC,aAfF,KAgBO,oBAhBP,CAkBA,MAAO,IAAMC,CAAAA,eAAe,0FAAG,iBAAOC,QAAP,CAAiBC,KAAjB,CAAwBC,QAAxB,4JACzB,kBAAAD,KAAK,CAACE,QAAN,0DAAgBC,MAAhB,IAA2B,GAA3B,EAAkC,mBAAAH,KAAK,CAACE,QAAN,4DAAgBC,MAAhB,IAA2B,GADpC,iEAGnBF,CAAAA,QAAQ,CAACpB,gBAAgB,EAAjB,CAHW,QAIzBoB,QAAQ,CAACF,QAAQ,EAAT,CAAR,CAJyB,+EAMzBjB,KAAK,CAACsB,KAAN,GANyB,oEAAH,kBAAfN,CAAAA,eAAe,oDAArB,CAWP,GAAMO,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,mGAAM,kBAAMJ,QAAN,mIACxBA,QAAQ,CAACR,eAAe,EAAhB,CAAR,CADwB,wCAGCb,CAAAA,KAAK,CAAC0B,GAAN,CAAU,yCAAV,CAHD,QAGhBJ,QAHgB,gBAKtBD,QAAQ,CACNf,eAAe,CACbgB,QAAQ,CAACK,IAAT,CAAcC,WAAd,CAA0BC,IAA1B,GAAmC,OAAnC,CAA6CP,QAAQ,CAACK,IAAtD,CAA6D,EADhD,CADT,CAAR,CALsB,mFAWtBN,QAAQ,CAACJ,aAAa,mDAAC,aAAOa,OAAR,CAAd,CAAR,CACAZ,eAAe,CAACO,WAAD,cAAqBJ,QAArB,CAAf,CAZsB,sEAAN,kEAApB,CAgBA,GAAMU,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAAC,OAAO,kGAAI,kBAAMX,QAAN,iJAC/BA,QAAQ,CAACjB,oBAAoB,EAArB,CAAR,CAD+B,wCAINJ,CAAAA,KAAK,CAACiC,IAAN,CACrB,yCADqB,CAErBD,OAFqB,CAJM,yCAIrBL,IAJqB,mBAIrBA,IAJqB,CAQ7BN,QAAQ,CAAChB,oBAAoB,gCAAMsB,IAAN,MAAYO,GAAG,CAAEP,IAAI,CAACQ,EAAtB,GAArB,CAAR,CAR6B,mFAU7Bd,QAAQ,CAAClB,kBAAkB,mDAAC,aAAO2B,OAAR,CAAnB,CAAR,CACAZ,eAAe,CAAC,iBAAMa,CAAAA,aAAa,CAACC,OAAD,CAAnB,EAAD,cAAsCX,QAAtC,CAAf,CAX6B,sEAAJ,kEAA7B,CAeA,GAAMe,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAAAC,SAAS,kGAAI,kBAAMhB,QAAN,gIAC3BiB,KAD2B,CACnBD,SADmB,CAEjChB,QAAQ,CAACd,oBAAoB,EAArB,CAAR,CAEA,GAAI,CACFP,KAAK,CAACuC,MAAN,mDAAwDD,KAAxD,GAEAjB,QAAQ,CAACb,oBAAoB,CAAC8B,KAAD,CAArB,CAAR,CACD,CAAC,MAAOlB,KAAP,CAAc,CACdC,QAAQ,CAACZ,kBAAkB,CAACW,KAAD,SAACA,KAAD,iBAACA,KAAK,CAAEU,OAAR,CAAnB,CAAR,CACAZ,eAAe,CAAC,iBAAMkB,CAAAA,aAAa,CAACC,SAAD,CAAnB,EAAD,CAAiCjB,KAAjC,CAAwCC,QAAxC,CAAf,CACD,CAXgC,wDAAJ,kEAA/B,CAcArB,KAAK,CAACwC,QAAN,CAAeC,OAAf,CAAyB,iCAAzB,CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,KAAD,CAAQN,SAAR,kGAAsB,kBAAMhB,QAAN,kJACtCA,QAAQ,CAACN,gBAAgB,EAAjB,CAAR,CADsC,wCAGbf,CAAAA,KAAK,CAAC4C,KAAN,gCACGP,SADH,EAErBM,KAFqB,CAHa,0CAG5BhB,IAH4B,oBAG5BA,IAH4B,CAOpCN,QAAQ,CACNL,gBAAgB,CAAC,CACf6B,OAAO,CAAElB,IAAI,CAACmB,UADC,CAEfT,SAAS,CAATA,SAFe,CAAD,CADV,CAAR,CAPoC,mFAcpChB,QAAQ,CAACP,cAAc,mDAAC,aAAOgB,OAAR,CAAf,CAAR,CACAZ,eAAe,CAAC,iBAAMwB,CAAAA,SAAS,CAACC,KAAD,CAAQN,SAAR,CAAf,EAAD,cAA2ChB,QAA3C,CAAf,CAfoC,sEAAtB,kEAAlB,CAmBA,GAAM0B,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACV,SAAD,CAAYW,KAAZ,kGAAsB,kBAAM3B,QAAN,sHACtCA,QAAQ,CAACX,uBAAuB,EAAxB,CAAR,CADsC,wCAI9BV,CAAAA,KAAK,CAAC4C,KAAN,0BAA8BP,SAA9B,EAA2C,CAAEW,KAAK,CAALA,KAAF,CAA3C,CAJ8B,QAKpC3B,QAAQ,CAACV,uBAAuB,CAAC,CAAE0B,SAAS,CAATA,SAAF,CAAaW,KAAK,CAALA,KAAb,CAAD,CAAxB,CAAR,CALoC,mFAOpC3B,QAAQ,CAACT,qBAAqB,mDAAC,aAAOkB,OAAR,CAAtB,CAAR,CACAZ,eAAe,CAAC,iBAAM6B,CAAAA,SAAS,CAACV,SAAD,CAAYW,KAAZ,CAAf,EAAD,cAA2C3B,QAA3C,CAAf,CARoC,sEAAtB,kEAAlB,CAYA,OAASI,WAAT,CAAsBM,aAAtB,CAAqCK,aAArC,CAAoDW,SAApD,CAA+DL,SAA/D","sourcesContent":["import axios from 'axios';\nimport { refreshOperation, token } from '../auth/auth-operations';\nimport {\n  createProjectError,\n  createProjectRequest,\n  createProjectSuccess,\n  projectsSuccess,\n  deleteProjectRequest,\n  deleteProjectSuccess,\n  deleteProjectError,\n  editProjectTitleRequest,\n  editProjectTitleSuccess,\n  editProjectTitleError,\n  projectsRequest,\n  addMemberError,\n  addMemberRequest,\n  addMemberSuccess,\n  projectsError,\n} from './projects-actions';\n\nexport const refreshTemplate = async (callback, error, dispatch) => {\n  if (error.response?.status === 401 || error.response?.status === 404) {\n    try {\n      await dispatch(refreshOperation());\n      dispatch(callback());\n    } catch (error) {\n      token.unset();\n    }\n  }\n};\n\nconst getProjects = () => async dispatch => {\n  dispatch(projectsRequest());\n  try {\n    const response = await axios.get('https://sbc-backend.goit.global/project');\n\n    dispatch(\n      projectsSuccess(\n        response.data.constructor.name === 'Array' ? response.data : [],\n      ),\n    );\n  } catch (error) {\n    dispatch(projectsError(error?.message));\n    refreshTemplate(getProjects, error, dispatch);\n  }\n};\n\nconst createProject = project => async dispatch => {\n  dispatch(createProjectRequest());\n\n  try {\n    const { data } = await axios.post(\n      'https://sbc-backend.goit.global/project',\n      project,\n    );\n    dispatch(createProjectSuccess({ ...data, _id: data.id }));\n  } catch (error) {\n    dispatch(createProjectError(error?.message));\n    refreshTemplate(() => createProject(project), error, dispatch);\n  }\n};\n\nconst deleteProject = projectId => async dispatch => {\n  const newID = projectId;\n  dispatch(deleteProjectRequest());\n\n  try {\n    axios.delete(`https://sbc-backend.goit.global/project/${newID}`);\n\n    dispatch(deleteProjectSuccess(newID));\n  } catch (error) {\n    dispatch(deleteProjectError(error?.message));\n    refreshTemplate(() => deleteProject(projectId), error, dispatch);\n  }\n};\n\naxios.defaults.baseURL = 'https://sbc-backend.goit.global';\n\nconst addMember = (email, projectId) => async dispatch => {\n  dispatch(addMemberRequest());\n  try {\n    const { data } = await axios.patch(\n      `/project/contributor/${projectId}`,\n      email,\n    );\n    dispatch(\n      addMemberSuccess({\n        members: data.newMembers,\n        projectId,\n      }),\n    );\n  } catch (error) {\n    dispatch(addMemberError(error?.message));\n    refreshTemplate(() => addMember(email, projectId), error, dispatch);\n  }\n};\n\nconst editTitle = (projectId, title) => async dispatch => {\n  dispatch(editProjectTitleRequest());\n\n  try {\n    await axios.patch(`/project/title/${projectId}`, { title });\n    dispatch(editProjectTitleSuccess({ projectId, title }));\n  } catch (error) {\n    dispatch(editProjectTitleError(error?.message));\n    refreshTemplate(() => editTitle(projectId, title), error, dispatch);\n  }\n};\n\nexport { getProjects, createProject, deleteProject, editTitle, addMember };\n"]},"metadata":{},"sourceType":"module"}